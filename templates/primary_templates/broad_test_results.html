{% extends "../extensible_templates/nav_on_top.html" %}

{% block title %}Broad Test Results{% endblock %}

{% block content %}

<div id="broad-test-results-widget" class="text-center mt-4 mx-4 border-gray-100 bg-gray-50 shadow-lg rounded-lg p-6 hover:bg-gray-100 hover:shadow-xl transition duration-300">
   
    <form method="get" action="/broad-test-results" class="mb-6">
        <button id="dropdownTestNamesButton" data-dropdown-toggle="dropdownTestNames" class="inline-flex items-center px-4 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800" type="button">Select Test Names</button>

        <!-- Make this into a dropdown checkbox menu -->
        <div id="dropdownTestNames" class="z-10 hidden bg-white rounded-lg shadow w-60 dark:bg-gray-700">
            <ul class="h-48 px-3 pb-3 overflow-y-auto text-sm text-gray-700 dark:text-gray-200" aria-labelledby="dropdownTestNamesButton">
                {% for test_name in test_names %}
                <li>
                    <div class="flex items-center p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-600">
                        <input id="checkbox_{{ loop.index0 }}" name="test_names" type="checkbox" value="{{ test_name }}" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
                        <label for="checkbox_{{ loop.index0 }}" class="w-full ms-2 text-sm font-medium text-gray-900 rounded dark:text-gray-300">{{ test_name }}</label>
                    </div>
                </li>
                {% endfor %}
            </ul>
        </div>


        <label for="pass_filter" class="block mb-2 text-lg font-bold">Pass/Fail Filter:</label>
        <select id="pass_filter" name="pass_filter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 mb-4">
            <option value="both">Both</option>
            <option value="passing">Passing</option>
            <option value="failing">Failing</option>
        </select>

        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300">
            Search Testees
        </button>
    </form>




    {% match test_list_items %}
    
        {% when Some with (items) %}

            {% if items.len() == 0 %}
                <p>No data found matching the given parameters</p>
            {% else %}

                <table class="bg-white w-full mx-1 table-fixed">
                    <thead class="sticky top-0 bg-white z-10">
                        <!-- Create the Overall Scoring Category Headers -->
                        <tr>
                                <th class="lg:text-4xl py-2">Testee Name</th>
                                <th class="lg:text-4xl py-2">Test Name</th>
                                <th class="lg:text-4xl py-2">Pass Status</th>
                                
                        </tr>
                    </thead>

                    <tbody>

                            {% for item in items %}
                            <tr>
                                <td class="py-2 px-4 border-b font-bold sm:text-sm md:text-xl lg:text-2xl text-right hover:underline">
                                    <a href="/test-summaries/{{ item.testee_id }}" hx-boost="true" hx-select="#primary-content" hx-target="#primary-content" hx-swap="outerHTML">
                                        {{ item.testee_first_name }} {{ item.testee_last_name }}
                                    </a> 
                                </td>
                                <td class="py-2 px-4 border-b font-bold sm:text-sm md:text-xl lg:text-2xl text-right hover:underline">
                                    <a href="/test-results/{{ item.test_id }}" hx-boost="true" hx-select="#primary-content" hx-target="#primary-content" hx-swap="outerHTML">
                                        {{ item.test_name }}
                                    </a>
                                </td>
                                <td class="py-2 px-4 border-b font-bold sm:text-sm md:text-xl lg:text-2xl text-right hover:underline">
                                    {% if item.is_passing %}<span class="text-green-700 font-bold">Pass</span>{% else %} <span class="text-red-700 font-bold">Fail</span>{% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        
                    </tbody>
            {% endif %}

        {% when None %}
        <p class="hidden">Nothing has been searched yet.</p>
        {% endmatch %}
</div>
{% endblock %}
